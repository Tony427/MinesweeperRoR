<div class="container"
     data-controller="minesweeper"
     data-minesweeper-board-data-value="<%= @board.board_data %>"
     data-minesweeper-width-value="<%= @board.width %>"
     data-minesweeper-height-value="<%= @board.height %>"
     data-minesweeper-mines-value="<%= @board.mines_count %>">

  <div class="d-flex justify-content-between align-items-center">
    <div>
      <h2><%= @board.name %></h2>
      <p class="text-muted">Created by: <%= @board.email %></p>
    </div>
    <div id="game-status" data-controller="game-status" class="h3">
      <span class="badge bg-primary">
        Mines: <span data-game-status-target="mines"><%= @board.mines_count %></span>
      </span>
      <span class="badge bg-info">
        Status: <span data-game-status-target="status">Playing</span>
      </span>
      <span class="badge bg-secondary">
        Time: <span data-game-status-target="timer">0</span>s
      </span>
    </div>
  </div>


  <div class="mt-4">
    <div class="board-grid"
         data-minesweeper-target="board"
         data-controller="game-board"
         data-game-board-width-value="<%= @board.width %>"
         data-game-board-height-value="<%= @board.height %>"
         style="display: grid; grid-template-columns: repeat(<%= @board.width %>, 2rem); gap: 2px; margin-top: 1rem; user-select: none;">

      <% JSON.parse(@board.board_data).each_with_index do |row, row_index| %>
        <% row.each_with_index do |cell, col_index| %>
          <div class="cell covered"
               data-action="click->game-board#reveal contextmenu->game-board#toggle"
               data-game-board-target="cell"
               data-row="<%= row_index %>"
               data-col="<%= col_index %>"
               style="width: 2rem; height: 2rem; display: flex; justify-content: center; align-items: center; cursor: pointer; font-weight: bold; font-size: 0.9rem; background-color: #e9ecef; border: 2px outset #ddd; color: #000;">
          </div>
        <% end %>
      <% end %>
    </div>
  </div>

  <div class="mt-4">
    <%= link_to 'Back to Home', root_path, class: 'btn btn-secondary' %>
    <button data-minesweeper-target="resetBtn" data-action="click->minesweeper#reset" class="btn btn-primary">Reset Game</button>
  </div>
</div>