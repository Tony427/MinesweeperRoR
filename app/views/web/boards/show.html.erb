<div class="row">
  <div class="col-md-8">
    <h1 class="game-title"><%= @board.name %></h1>
    <div class="mb-3">
      <p class="text-muted mb-1">Created by: <strong><%= @board.email %></strong></p>
      <p class="text-muted mb-1">Created at: <%= @board.created_at.strftime("%B %d, %Y at %I:%M %p") %></p>
      <p class="text-muted">Dimensions: <strong><%= @board.width %>Ã—<%= @board.height %></strong>, Mines: <strong><%= @board.mines_count %></strong></p>
    </div>
  </div>
</div>

<div class="mt-4" 
     data-controller="minesweeper"
     data-minesweeper-width-value="<%= @board.width %>"
     data-minesweeper-height-value="<%= @board.height %>"
     data-minesweeper-mines-value="<%= @board.mines_count %>"
     data-minesweeper-board-data-value="<%= @board.board_data %>">
  
  <h4>Minesweeper Game</h4>
  
  <!-- Game Status Bar -->
  <div class="game-status-bar" data-controller="game-status">
    <div class="status-item">
      <span class="badge bg-primary">
        Mines: <span data-game-status-target="mines"><%= @board.mines_count %></span>
      </span>
    </div>
    <div class="status-item">
      <span class="badge bg-info">
        Status: <span data-game-status-target="status">Playing</span>
      </span>
    </div>
    <div class="status-item">
      <span class="badge bg-secondary">
        Time: <span data-game-status-target="timer" class="game-timer">0</span>s
      </span>
    </div>
  </div>

  <!-- Game Controls -->
  <div class="game-buttons">
    <button data-minesweeper-target="resetBtn" 
            data-action="click->minesweeper#reset" 
            class="btn btn-success reset-button">
      <span class="btn-text">New Game</span>
    </button>
  </div>
  
  <!-- Game Board -->
  <div class="game-board-container">
    <div data-minesweeper-target="board"
         data-controller="game-board"
         data-game-board-width="<%= @board.width %>"
         data-game-board-height="<%= @board.height %>"
         class="game-board"
         style="grid-template-columns: repeat(<%= @board.width %>, var(--cell-size)); grid-template-rows: repeat(<%= @board.height %>, var(--cell-size));"
         tabindex="0">
      <% JSON.parse(@board.board_data).each_with_index do |row, row_idx| %>
        <% row.each_with_index do |cell, col_idx| %>
          <div 
            class="game-cell" 
            data-game-board-target="cell"
            data-row="<%= row_idx %>" 
            data-col="<%= col_idx %>" 
            data-mine="<%= cell['mine'] ? 'true' : 'false' %>"
            data-action="click->game-board#reveal contextmenu->game-board#toggle"
            tabindex="-1">
          </div>
        <% end %>
      <% end %>
    </div>
  </div>
  
  <!-- Game Statistics -->
  <div class="mt-3">
    <small class="game-stats text-muted">
      Total cells: <%= @board.width * @board.height %> | 
      Mine density: <%= ((@board.mines_count.to_f / (@board.width * @board.height)) * 100).round(1) %>%
    </small>
  </div>
  
  <!-- Game Instructions -->
  <div class="mt-3">
    <div class="alert alert-info game-instructions">
      <strong>How to play:</strong>
      <ul class="mb-0">
        <li><strong>Left click</strong> or <strong>Space/Enter</strong> to reveal a cell</li>
        <li><strong>Right click</strong> or <strong>F key</strong> to flag/unflag a mine</li>
        <li><strong>Arrow keys</strong> for keyboard navigation</li>
        <li>Numbers show adjacent mines</li>
        <li>Avoid clicking on mines!</li>
      </ul>
    </div>
  </div>
</div>

<div class="mt-4">
  <%= link_to "Back to Home", root_path, class: "btn btn-secondary" %>
  <%= link_to "View All Boards", all_boards_path, class: "btn btn-outline-secondary" %>
  <%= link_to "Generate New Board", root_path, class: "btn btn-primary" %>
</div>